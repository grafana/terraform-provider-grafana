---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "grafana_apps_alertenrichment_alertenrichment_v1beta1 Resource - terraform-provider-grafana"
subcategory: "Alerting"
description: |-
  Manages Grafana Cloud Alert Enrichment https://grafana.com/docs/grafana-cloud/alerting-and-irm/alerting/configure-notifications/alert-enrichment/.
  Alert enrichment is currently in private preview. Grafana Labs offers support on a best-effort basis, and breaking changes might occur prior to the feature being made generally available
---

# grafana_apps_alertenrichment_alertenrichment_v1beta1 (Resource)

Manages [Grafana Cloud Alert Enrichment](https://grafana.com/docs/grafana-cloud/alerting-and-irm/alerting/configure-notifications/alert-enrichment/).

Alert enrichment is currently in private preview. Grafana Labs offers support on a best-effort basis, and breaking changes might occur prior to the feature being made generally available

## Example Usage

```terraform
resource "grafana_apps_alertenrichment_alertenrichment_v1beta1" "enrichment" {
  metadata {
    uid = "test_enrichment"
  }

  spec {
    title       = "Comprehensive alert enrichment"
    description = "Demonstrates many enrichment steps and configurations"

    # Target specific alert rules by UIDs
    alert_rule_uids = ["alert-rule-1", "alert-rule-2"]

    # Target specific receiver names
    receivers = ["webhook", "slack-critical"]

    # Label matchers - supports =, !=, =~, !~ operators
    label_matchers = [
      {
        type  = "="
        name  = "severity"
        value = "critical"
      },
      {
        type  = "=~"
        name  = "team"
        value = "alerting|alerting-team"
      }
    ]

    # Annotation matchers
    annotation_matchers = [
      {
        type  = "!="
        name  = "runbook_url"
        value = ""
      }
    ]

    # Adds annotations to alerts with the assign step
    step {
      assign {
        timeout = "30s"
        annotations = {
          "priority"    = "high"
          "runbook_url" = "https://runbooks.grafana.com/alert-handling"
        }
      }
    }

    # Calls external service
    step {
      external {
        url = "https://some-api.grafana.com/alert-enrichment"
      }
    }

    # Data source step with logs query
    step {
      data_source {
        timeout = "30s"

        logs_query {
          data_source_type = "loki"
          data_source_uid  = "loki-uid-123"
          expr             = "{job=\"my-app\"} |= \"error\""
          max_lines        = 5
        }
      }
    }

    # Data source step with raw query
    step {
      data_source {
        timeout = "30s"

        raw_query {
          ref_id = "A"
          request = jsonencode({
            datasource = {
              type = "prometheus"
              uid  = "prometheus-uid-456"
            }
            expr          = "rate(http_requests_total[5m])"
            refId         = "A"
            intervalMs    = 1000
            maxDataPoints = 43200
          })
        }
      }
    }

    # Triggers a new Sift investigation
    step {
      sift {}
    }

    # Generates AI explanation of the alert using Grafana LLM plugin
    step {
      explain {
        annotation = "ai_explanation"
      }
    }


    # Trigger a new Assistant Investigation
    step {
      assistant_investigations {}
    }

    # Conditional step runs different actions based on alert severity
    step {
      conditional {
        # Condition: Check if severity is critical
        if {
          label_matchers = [{
            type  = "="
            name  = "severity"
            value = "critical"
          }]
        }

        # Actions for critical alerts
        then {
          step {
            assign {
              annotations = {
                escalation_level = "immediate"
              }
            }
          }
          step {
            external {
              url = "https://irm.grafana.com/create-incident"
            }
          }
        }

        # Actions for non-critical alerts
        else {
          step {
            assign {
              annotations = {
                escalation_level = "standard"
              }
            }
          }
        }
      }
    }
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Optional

- `metadata` (Block, Optional) The metadata of the resource. (see [below for nested schema](#nestedblock--metadata))
- `options` (Block, Optional) Options for applying the resource. (see [below for nested schema](#nestedblock--options))
- `spec` (Block, Optional) The spec of the resource. (see [below for nested schema](#nestedblock--spec))

### Read-Only

- `id` (String) The ID of the resource derived from UUID.

<a id="nestedblock--metadata"></a>
### Nested Schema for `metadata`

Required:

- `uid` (String) The unique identifier of the resource.

Optional:

- `folder_uid` (String) The UID of the folder to save the resource in.

Read-Only:

- `annotations` (Map of String) Annotations of the resource.
- `url` (String) The full URL of the resource.
- `uuid` (String) The globally unique identifier of a resource, used by the API for tracking.
- `version` (String) The version of the resource.


<a id="nestedblock--options"></a>
### Nested Schema for `options`

Optional:

- `overwrite` (Boolean) Set to true if you want to overwrite existing resource with newer version, same resource title in folder or same resource uid.


<a id="nestedblock--spec"></a>
### Nested Schema for `spec`

Required:

- `title` (String) The title of the alert enrichment.

Optional:

- `alert_rule_uids` (List of String) UIDs of alert rules this enrichment applies to. If empty, applies to all alert rules.
- `annotation_matchers` (List of Object) Annotation matchers that an alert must satisfy for this enrichment to apply. Each matcher is an object with: 'type' (string, one of: =, !=, =~, !~), 'name' (string, annotation key to match), 'value' (string, annotation value to compare against, supports regex for =~/!~ operators). (see [below for nested schema](#nestedatt--spec--annotation_matchers))
- `description` (String) Description of the alert enrichment.
- `disable_provenance` (Boolean) Allow modifying alert enrichment outside of Terraform
- `label_matchers` (List of Object) Label matchers that an alert must satisfy for this enrichment to apply. Each matcher is an object with: 'type' (string, one of: =, !=, =~, !~), 'name' (string, label key to match), 'value' (string, label value to compare against, supports regex for =~/!~ operators). (see [below for nested schema](#nestedatt--spec--label_matchers))
- `receivers` (List of String) Receiver names to match. If empty, applies to all receivers.
- `step` (Block List) Enrichment step. Can be repeated multiple times to define a sequence of steps. Each step must contain exactly one enrichment block. (see [below for nested schema](#nestedblock--spec--step))

<a id="nestedatt--spec--annotation_matchers"></a>
### Nested Schema for `spec.annotation_matchers`

Optional:

- `name` (String)
- `type` (String)
- `value` (String)


<a id="nestedatt--spec--label_matchers"></a>
### Nested Schema for `spec.label_matchers`

Optional:

- `name` (String)
- `type` (String)
- `value` (String)


<a id="nestedblock--spec--step"></a>
### Nested Schema for `spec.step`

Optional:

- `asserts` (Block, Optional) Integrate with Grafana Asserts for enrichment. (see [below for nested schema](#nestedblock--spec--step--asserts))
- `assign` (Block, Optional) Assign annotations to an alert. (see [below for nested schema](#nestedblock--spec--step--assign))
- `assistant_investigations` (Block, Optional) Use AI assistant to investigate alerts and add insights. (see [below for nested schema](#nestedblock--spec--step--assistant_investigations))
- `conditional` (Block, Optional) Conditional step with if/then/else. (see [below for nested schema](#nestedblock--spec--step--conditional))
- `data_source` (Block, Optional) Query Grafana data sources and add results to alerts. (see [below for nested schema](#nestedblock--spec--step--data_source))
- `explain` (Block, Optional) Generate AI explanation and store in an annotation. (see [below for nested schema](#nestedblock--spec--step--explain))
- `external` (Block, Optional) Call an external HTTP service for enrichment. (see [below for nested schema](#nestedblock--spec--step--external))
- `sift` (Block, Optional) Analyze alerts for patterns and insights. (see [below for nested schema](#nestedblock--spec--step--sift))

<a id="nestedblock--spec--step--asserts"></a>
### Nested Schema for `spec.step.asserts`

Optional:

- `timeout` (String) Maximum execution time (e.g., '30s', '1m')


<a id="nestedblock--spec--step--assign"></a>
### Nested Schema for `spec.step.assign`

Optional:

- `annotations` (Map of String) Map of annotation names to values to set on matching alerts.
- `timeout` (String) Maximum execution time (e.g., '30s', '1m')


<a id="nestedblock--spec--step--assistant_investigations"></a>
### Nested Schema for `spec.step.assistant_investigations`

Optional:

- `timeout` (String) Maximum execution time (e.g., '30s', '1m')


<a id="nestedblock--spec--step--conditional"></a>
### Nested Schema for `spec.step.conditional`

Optional:

- `else` (Block, Optional) Steps when condition is false. (see [below for nested schema](#nestedblock--spec--step--conditional--else))
- `if` (Block, Optional) Condition to evaluate. (see [below for nested schema](#nestedblock--spec--step--conditional--if))
- `then` (Block, Optional) Steps when condition is true. (see [below for nested schema](#nestedblock--spec--step--conditional--then))
- `timeout` (String) Maximum execution time (e.g., '30s', '1m')

<a id="nestedblock--spec--step--conditional--else"></a>
### Nested Schema for `spec.step.conditional.else`

Optional:

- `step` (Block List) (see [below for nested schema](#nestedblock--spec--step--conditional--else--step))

<a id="nestedblock--spec--step--conditional--else--step"></a>
### Nested Schema for `spec.step.conditional.else.step`

Optional:

- `asserts` (Block, Optional) Integrate with Grafana Asserts for enrichment. (see [below for nested schema](#nestedblock--spec--step--conditional--else--step--asserts))
- `assign` (Block, Optional) Assign annotations to an alert. (see [below for nested schema](#nestedblock--spec--step--conditional--else--step--assign))
- `assistant_investigations` (Block, Optional) Use AI assistant to investigate alerts and add insights. (see [below for nested schema](#nestedblock--spec--step--conditional--else--step--assistant_investigations))
- `data_source` (Block, Optional) Query Grafana data sources and add results to alerts. (see [below for nested schema](#nestedblock--spec--step--conditional--else--step--data_source))
- `explain` (Block, Optional) Generate AI explanation and store in an annotation. (see [below for nested schema](#nestedblock--spec--step--conditional--else--step--explain))
- `external` (Block, Optional) Call an external HTTP service for enrichment. (see [below for nested schema](#nestedblock--spec--step--conditional--else--step--external))
- `sift` (Block, Optional) Analyze alerts for patterns and insights. (see [below for nested schema](#nestedblock--spec--step--conditional--else--step--sift))

<a id="nestedblock--spec--step--conditional--else--step--asserts"></a>
### Nested Schema for `spec.step.conditional.else.step.asserts`

Optional:

- `timeout` (String) Maximum execution time (e.g., '30s', '1m')


<a id="nestedblock--spec--step--conditional--else--step--assign"></a>
### Nested Schema for `spec.step.conditional.else.step.assign`

Optional:

- `annotations` (Map of String) Map of annotation names to values to set on matching alerts.
- `timeout` (String) Maximum execution time (e.g., '30s', '1m')


<a id="nestedblock--spec--step--conditional--else--step--assistant_investigations"></a>
### Nested Schema for `spec.step.conditional.else.step.assistant_investigations`

Optional:

- `timeout` (String) Maximum execution time (e.g., '30s', '1m')


<a id="nestedblock--spec--step--conditional--else--step--data_source"></a>
### Nested Schema for `spec.step.conditional.else.step.data_source`

Optional:

- `logs_query` (Block, Optional) Logs query configuration for querying log data sources. (see [below for nested schema](#nestedblock--spec--step--conditional--else--step--data_source--logs_query))
- `raw_query` (Block, Optional) Raw query configuration for advanced data source queries. (see [below for nested schema](#nestedblock--spec--step--conditional--else--step--data_source--raw_query))
- `timeout` (String) Maximum execution time (e.g., '30s', '1m')

<a id="nestedblock--spec--step--conditional--else--step--data_source--logs_query"></a>
### Nested Schema for `spec.step.conditional.else.step.data_source.logs_query`

Optional:

- `data_source_type` (String) Data source type (e.g., 'loki').
- `data_source_uid` (String) UID of the data source to query.
- `expr` (String) Log query expression to execute.
- `max_lines` (Number) Maximum number of log lines to include. Defaults to 3.


<a id="nestedblock--spec--step--conditional--else--step--data_source--raw_query"></a>
### Nested Schema for `spec.step.conditional.else.step.data_source.raw_query`

Optional:

- `ref_id` (String) Reference ID for correlating queries.
- `request` (String) Raw request payload for the data source query.



<a id="nestedblock--spec--step--conditional--else--step--explain"></a>
### Nested Schema for `spec.step.conditional.else.step.explain`

Optional:

- `annotation` (String) Annotation name to set the explanation in. Defaults to 'ai_explanation'.
- `timeout` (String) Maximum execution time (e.g., '30s', '1m')


<a id="nestedblock--spec--step--conditional--else--step--external"></a>
### Nested Schema for `spec.step.conditional.else.step.external`

Optional:

- `timeout` (String) Maximum execution time (e.g., '30s', '1m')
- `url` (String) HTTP endpoint URL to call for enrichment


<a id="nestedblock--spec--step--conditional--else--step--sift"></a>
### Nested Schema for `spec.step.conditional.else.step.sift`

Optional:

- `timeout` (String) Maximum execution time (e.g., '30s', '1m')




<a id="nestedblock--spec--step--conditional--if"></a>
### Nested Schema for `spec.step.conditional.if`

Optional:

- `annotation_matchers` (List of Object) Annotation matchers for the condition. (see [below for nested schema](#nestedatt--spec--step--conditional--if--annotation_matchers))
- `data_source_condition` (Block, Optional) Data source condition. (see [below for nested schema](#nestedblock--spec--step--conditional--if--data_source_condition))
- `label_matchers` (List of Object) Label matchers for the condition. (see [below for nested schema](#nestedatt--spec--step--conditional--if--label_matchers))

<a id="nestedatt--spec--step--conditional--if--annotation_matchers"></a>
### Nested Schema for `spec.step.conditional.if.annotation_matchers`

Optional:

- `name` (String)
- `type` (String)
- `value` (String)


<a id="nestedblock--spec--step--conditional--if--data_source_condition"></a>
### Nested Schema for `spec.step.conditional.if.data_source_condition`

Optional:

- `request` (String) Data source request payload.


<a id="nestedatt--spec--step--conditional--if--label_matchers"></a>
### Nested Schema for `spec.step.conditional.if.label_matchers`

Optional:

- `name` (String)
- `type` (String)
- `value` (String)



<a id="nestedblock--spec--step--conditional--then"></a>
### Nested Schema for `spec.step.conditional.then`

Optional:

- `step` (Block List) (see [below for nested schema](#nestedblock--spec--step--conditional--then--step))

<a id="nestedblock--spec--step--conditional--then--step"></a>
### Nested Schema for `spec.step.conditional.then.step`

Optional:

- `asserts` (Block, Optional) Integrate with Grafana Asserts for enrichment. (see [below for nested schema](#nestedblock--spec--step--conditional--then--step--asserts))
- `assign` (Block, Optional) Assign annotations to an alert. (see [below for nested schema](#nestedblock--spec--step--conditional--then--step--assign))
- `assistant_investigations` (Block, Optional) Use AI assistant to investigate alerts and add insights. (see [below for nested schema](#nestedblock--spec--step--conditional--then--step--assistant_investigations))
- `data_source` (Block, Optional) Query Grafana data sources and add results to alerts. (see [below for nested schema](#nestedblock--spec--step--conditional--then--step--data_source))
- `explain` (Block, Optional) Generate AI explanation and store in an annotation. (see [below for nested schema](#nestedblock--spec--step--conditional--then--step--explain))
- `external` (Block, Optional) Call an external HTTP service for enrichment. (see [below for nested schema](#nestedblock--spec--step--conditional--then--step--external))
- `sift` (Block, Optional) Analyze alerts for patterns and insights. (see [below for nested schema](#nestedblock--spec--step--conditional--then--step--sift))

<a id="nestedblock--spec--step--conditional--then--step--asserts"></a>
### Nested Schema for `spec.step.conditional.then.step.asserts`

Optional:

- `timeout` (String) Maximum execution time (e.g., '30s', '1m')


<a id="nestedblock--spec--step--conditional--then--step--assign"></a>
### Nested Schema for `spec.step.conditional.then.step.assign`

Optional:

- `annotations` (Map of String) Map of annotation names to values to set on matching alerts.
- `timeout` (String) Maximum execution time (e.g., '30s', '1m')


<a id="nestedblock--spec--step--conditional--then--step--assistant_investigations"></a>
### Nested Schema for `spec.step.conditional.then.step.assistant_investigations`

Optional:

- `timeout` (String) Maximum execution time (e.g., '30s', '1m')


<a id="nestedblock--spec--step--conditional--then--step--data_source"></a>
### Nested Schema for `spec.step.conditional.then.step.data_source`

Optional:

- `logs_query` (Block, Optional) Logs query configuration for querying log data sources. (see [below for nested schema](#nestedblock--spec--step--conditional--then--step--data_source--logs_query))
- `raw_query` (Block, Optional) Raw query configuration for advanced data source queries. (see [below for nested schema](#nestedblock--spec--step--conditional--then--step--data_source--raw_query))
- `timeout` (String) Maximum execution time (e.g., '30s', '1m')

<a id="nestedblock--spec--step--conditional--then--step--data_source--logs_query"></a>
### Nested Schema for `spec.step.conditional.then.step.data_source.logs_query`

Optional:

- `data_source_type` (String) Data source type (e.g., 'loki').
- `data_source_uid` (String) UID of the data source to query.
- `expr` (String) Log query expression to execute.
- `max_lines` (Number) Maximum number of log lines to include. Defaults to 3.


<a id="nestedblock--spec--step--conditional--then--step--data_source--raw_query"></a>
### Nested Schema for `spec.step.conditional.then.step.data_source.raw_query`

Optional:

- `ref_id` (String) Reference ID for correlating queries.
- `request` (String) Raw request payload for the data source query.



<a id="nestedblock--spec--step--conditional--then--step--explain"></a>
### Nested Schema for `spec.step.conditional.then.step.explain`

Optional:

- `annotation` (String) Annotation name to set the explanation in. Defaults to 'ai_explanation'.
- `timeout` (String) Maximum execution time (e.g., '30s', '1m')


<a id="nestedblock--spec--step--conditional--then--step--external"></a>
### Nested Schema for `spec.step.conditional.then.step.external`

Optional:

- `timeout` (String) Maximum execution time (e.g., '30s', '1m')
- `url` (String) HTTP endpoint URL to call for enrichment


<a id="nestedblock--spec--step--conditional--then--step--sift"></a>
### Nested Schema for `spec.step.conditional.then.step.sift`

Optional:

- `timeout` (String) Maximum execution time (e.g., '30s', '1m')





<a id="nestedblock--spec--step--data_source"></a>
### Nested Schema for `spec.step.data_source`

Optional:

- `logs_query` (Block, Optional) Logs query configuration for querying log data sources. (see [below for nested schema](#nestedblock--spec--step--data_source--logs_query))
- `raw_query` (Block, Optional) Raw query configuration for advanced data source queries. (see [below for nested schema](#nestedblock--spec--step--data_source--raw_query))
- `timeout` (String) Maximum execution time (e.g., '30s', '1m')

<a id="nestedblock--spec--step--data_source--logs_query"></a>
### Nested Schema for `spec.step.data_source.logs_query`

Optional:

- `data_source_type` (String) Data source type (e.g., 'loki').
- `data_source_uid` (String) UID of the data source to query.
- `expr` (String) Log query expression to execute.
- `max_lines` (Number) Maximum number of log lines to include. Defaults to 3.


<a id="nestedblock--spec--step--data_source--raw_query"></a>
### Nested Schema for `spec.step.data_source.raw_query`

Optional:

- `ref_id` (String) Reference ID for correlating queries.
- `request` (String) Raw request payload for the data source query.



<a id="nestedblock--spec--step--explain"></a>
### Nested Schema for `spec.step.explain`

Optional:

- `annotation` (String) Annotation name to set the explanation in. Defaults to 'ai_explanation'.
- `timeout` (String) Maximum execution time (e.g., '30s', '1m')


<a id="nestedblock--spec--step--external"></a>
### Nested Schema for `spec.step.external`

Optional:

- `timeout` (String) Maximum execution time (e.g., '30s', '1m')
- `url` (String) HTTP endpoint URL to call for enrichment


<a id="nestedblock--spec--step--sift"></a>
### Nested Schema for `spec.step.sift`

Optional:

- `timeout` (String) Maximum execution time (e.g., '30s', '1m')
