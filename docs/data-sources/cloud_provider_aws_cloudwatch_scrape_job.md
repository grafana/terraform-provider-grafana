---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "grafana_cloud_provider_aws_cloudwatch_scrape_job Data Source - terraform-provider-grafana"
subcategory: "Cloud Provider"
description: |-
  
---

# grafana_cloud_provider_aws_cloudwatch_scrape_job (Data Source)



## Example Usage

```terraform
data "grafana_cloud_stack" "test" {
  slug = "gcloudstacktest"
}

data "aws_iam_role" "test" {
  name = "my-role"
}

resource "grafana_cloud_provider_aws_account" "test" {
  stack_id = data.grafana_cloud_stack.test.id
  role_arn = data.aws_iam_role.test.arn
  regions = [
    "us-east-1",
    "us-east-2",
    "us-west-1"
  ]
}

locals {
  services = [
    {
      name = "AWS/EC2",
      metrics = [
        {
          name = "CPUUtilization",
          statistics = [
            "Average",
          ],
        },
        {
          name = "StatusCheckFailed",
          statistics = [
            "Maximum",
          ],
        },
      ],
      scrape_interval_seconds = 300,
      resource_discovery_tag_filters = [
        {
          key   = "k8s.io/cluster-autoscaler/enabled",
          value = "true",
        }
      ],
      tags_to_add_to_metrics = [
        "eks:cluster-name",
      ]
    },
  ]
  custom_namespaces = [
    {
      name = "CoolApp",
      metrics = [
        {
          name = "CoolMetric",
          statistics = [
            "Maximum",
            "Sum",
          ]
        },
      ],
      scrape_interval_seconds = 300,
    },
  ]
}

resource "grafana_cloud_provider_aws_cloudwatch_scrape_job" "test" {
  stack_id                = data.grafana_cloud_stack.test.id
  name                    = "my-cloudwatch-scrape-job"
  aws_account_resource_id = grafana_cloud_provider_aws_account.test.resource_id
  export_tags             = true

  dynamic "service" {
    for_each = local.services
    content {
      name = service.value.name
      dynamic "metric" {
        for_each = service.value.metrics
        content {
          name       = metric.value.name
          statistics = metric.value.statistics
        }
      }
      scrape_interval_seconds = service.value.scrape_interval_seconds
      dynamic "resource_discovery_tag_filter" {
        for_each = service.value.resource_discovery_tag_filters
        content {
          key   = resource_discovery_tag_filter.value.key
          value = resource_discovery_tag_filter.value.value
        }

      }
      tags_to_add_to_metrics = service.value.tags_to_add_to_metrics
    }
  }

  dynamic "custom_namespace" {
    for_each = local.custom_namespaces
    content {
      name = custom_namespace.value.name
      dynamic "metric" {
        for_each = custom_namespace.value.metrics
        content {
          name       = metric.value.name
          statistics = metric.value.statistics
        }
      }
      scrape_interval_seconds = custom_namespace.value.scrape_interval_seconds
    }
  }
}


data "grafana_cloud_provider_aws_cloudwatch_scrape_job" "test" {
  stack_id = data.grafana_cloud_stack.test.id
  name     = grafana_cloud_provider_aws_cloudwatch_scrape_job.test.name
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String) The name of the CloudWatch Scrape Job. Part of the Terraform Resource ID.
- `stack_id` (String) The Stack ID of the Grafana Cloud instance. Part of the Terraform Resource ID.

### Read-Only

- `aws_account_resource_id` (String) The ID assigned by the Grafana Cloud Provider API to an AWS Account resource that should be associated with this CloudWatch Scrape Job.
- `custom_namespace` (Block List) Zero or more configuration blocks to configure custom namespaces for the CloudWatch Scrape Job to scrape. Each block must have a distinct `name` attribute. When accessing this as an attribute reference, it is a list of objects. (see [below for nested schema](#nestedblock--custom_namespace))
- `disabled_reason` (String) When the CloudWatch Scrape Job is disabled, this will show the reason that it is in that state.
- `enabled` (Boolean) Whether the CloudWatch Scrape Job is enabled or not.
- `export_tags` (Boolean) When enabled, AWS resource tags are exported as Prometheus labels to metrics formatted as `aws_<service_name>_info`.
- `id` (String) The Terraform Resource ID. This has the format "{{ stack_id }}:{{ name }}".
- `regions` (Set of String) The set of AWS region names that this CloudWatch Scrape Job is configured to scrape.
- `regions_subset_override_used` (Boolean) Whether or not this CloudWatch Scrape Job is using a subset override of the associated account's regions set for scraping, as configured by the resource's `regions_subset_override` attribute. When true, the `regions` attribute will be the set of regions configured in the override. When false, the `regions` attribute will be the set of regions belonging to the AWS Account resource that is associated with this CloudWatch Scrape Job.
- `role_arn` (String) The AWS ARN of the IAM role associated with the AWS Account resource that is being used by this CloudWatch Scrape Job.
- `service` (Block List) One or more configuration blocks to dictate what this CloudWatch Scrape Job should scrape. Each block must have a distinct `name` attribute. When accessing this as an attribute reference, it is a list of objects. (see [below for nested schema](#nestedblock--service))

<a id="nestedblock--custom_namespace"></a>
### Nested Schema for `custom_namespace`

Read-Only:

- `metric` (Block List) One or more configuration blocks to configure metrics and their statistics to scrape. Each block must represent a distinct metric name. When accessing this as an attribute reference, it is a list of objects. (see [below for nested schema](#nestedblock--custom_namespace--metric))
- `name` (String) The name of the custom namespace to scrape.
- `scrape_interval_seconds` (Number) The interval in seconds to scrape the custom namespace.

<a id="nestedblock--custom_namespace--metric"></a>
### Nested Schema for `custom_namespace.metric`

Read-Only:

- `name` (String) The name of the metric to scrape.
- `statistics` (Set of String) A set of statistics to scrape.



<a id="nestedblock--service"></a>
### Nested Schema for `service`

Read-Only:

- `metric` (Block List) One or more configuration blocks to configure metrics and their statistics to scrape. Each block must represent a distinct metric name. When accessing this as an attribute reference, it is a list of objects. (see [below for nested schema](#nestedblock--service--metric))
- `name` (String) The name of the service to scrape. See https://grafana.com/docs/grafana-cloud/monitor-infrastructure/aws/cloudwatch-metrics/services/ for supported services, metrics, and their statistics.
- `resource_discovery_tag_filter` (Block List) One or more configuration blocks to configure tag filters applied to discovery of resource entities in the associated AWS account. When accessing this as an attribute reference, it is a list of objects. (see [below for nested schema](#nestedblock--service--resource_discovery_tag_filter))
- `scrape_interval_seconds` (Number) The interval in seconds to scrape the service. See https://grafana.com/docs/grafana-cloud/monitor-infrastructure/aws/cloudwatch-metrics/services/ for supported scrape intervals.
- `tags_to_add_to_metrics` (Set of String) A set of tags to add to all metrics exported by this scrape job, for use in PromQL queries.

<a id="nestedblock--service--metric"></a>
### Nested Schema for `service.metric`

Read-Only:

- `name` (String) The name of the metric to scrape.
- `statistics` (Set of String) A set of statistics to scrape.


<a id="nestedblock--service--resource_discovery_tag_filter"></a>
### Nested Schema for `service.resource_discovery_tag_filter`

Read-Only:

- `key` (String) The key of the tag filter.
- `value` (String) The value of the tag filter.
