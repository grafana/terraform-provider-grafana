# Agent Documentation Index

This directory contains detailed architecture documentation for AI assistants working in this repository.
Generated by comprehensive codebase analysis (10 domains, ~450 files, 95% confidence).

## Structure

```
.claude/docs/
├── README.md                    ← this file
├── resources/
│   ├── sdkv2.md                 ← SDKv2 legacy resource pattern (~65 resources)
│   ├── framework.md             ← Plugin Framework resource pattern (~26 resources)
│   └── appplatform.md           ← AppPlatform generic K8s-backed pattern (11 resources)
├── provider/
│   ├── mux-architecture.md      ← How the muxed provider is assembled
│   └── api-clients.md           ← All 13+ API clients, auth modes, client creation
├── testing/
│   └── infrastructure.md        ← Test gating, ProtoV5ProviderFactories, test patterns
└── generation/
    └── systems.md               ← Doc generation and config import generation systems
```

## Quick Reference: Which Layer to Use

| Scenario | Layer | Key file |
|----------|-------|----------|
| New REST-based resource | Plugin Framework | `.claude/docs/resources/framework.md` |
| Modifying existing OSS/Cloud/OnCall resource | SDKv2 | `.claude/docs/resources/sdkv2.md` |
| New Grafana App Platform (K8s API) resource | AppPlatform | `.claude/docs/resources/appplatform.md` |
| Understanding provider setup | Mux architecture | `.claude/docs/provider/mux-architecture.md` |
| Adding/debugging API client | API clients | `.claude/docs/provider/api-clients.md` |
| Writing acceptance tests | Testing | `.claude/docs/testing/infrastructure.md` |
| Doc generation or import tool | Generation | `.claude/docs/generation/systems.md` |

## Critical Files

| File | Purpose |
|------|---------|
| `pkg/provider/provider.go` | `MakeProviderServer()` — assembles mux |
| `pkg/provider/resources.go` | Resource aggregation, routing to SDKv2/Framework/AppPlatform |
| `pkg/provider/configure_clients.go` | All 13+ API client constructors |
| `internal/common/client.go` | `*common.Client` struct with all API clients + mutexes |
| `internal/common/resource.go` | `Resource`/`DataSource` wrappers, constructors |
| `internal/common/resource_id.go` | `ResourceID` typed composite ID system |
| `internal/common/errcheck.go` | `CheckReadError`, `WarnMissing`, `IsNotFoundError` |
| `internal/resources/appplatform/resource.go` | `Resource[T,L]` generic CRUD implementation |
| `internal/resources/grafana/oss_org_id.go` | Org-scoped ID helpers |
| `internal/testutils/provider.go` | `ProtoV5ProviderFactories`, test gating helpers |
