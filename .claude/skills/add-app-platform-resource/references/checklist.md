# AppPlatform Resource Checklist

Use this checklist to track all files that need to be created or modified when adding a new AppPlatform resource.

---

## Files to CREATE

### 1. Resource implementation
**Path**: `internal/resources/appplatform/<name>_resource.go`

Content must include:
- [ ] Package declaration: `package appplatform`
- [ ] Model struct(s): `<Name>SpecModel` with `tfsdk` struct tags
- [ ] Additional `types.ObjectType` vars for nested object types (e.g. `var myItemType = types.ObjectType{...}`)
- [ ] Constructor function: `func <Name>() NamedResource`
- [ ] `NewNamedResource[*<pkg>.<Kind>, *<pkg>.<Kind>List](category, ResourceConfig{...})`
- [ ] `ResourceConfig.Kind`: `<pkg>.<Kind>Kind()`
- [ ] `ResourceConfig.Schema.SpecAttributes`: all spec fields mapped
- [ ] `ResourceConfig.SpecParser`: TF `types.Object` → Go SDK spec struct
- [ ] `ResourceConfig.SpecSaver`: Go SDK struct → TF `types.Object`

### 2. Acceptance test
**Path**: `internal/resources/appplatform/<name>_resource_acc_test.go`

Content must include:
- [ ] Package declaration: `package appplatform_test` (external test package — NOT `package appplatform`)
- [ ] `const <name>ResourceName = "grafana_apps_<group>_<kind>_<version>.test"`
- [ ] `TestAcc<Name>_basic(t *testing.T)` function
- [ ] `testutils.Check<OSS|Enterprise>TestsEnabled(t, "<version>")` as the **first line** of each test
- [ ] `terraformresource.ParallelTest(...)` wrapping each test case
- [ ] `testutils.ProtoV5ProviderFactories` as the factory
- [ ] At least one `ImportState` step with:
  - [ ] `ImportStateVerifyIgnore: []string{"options.%", "options.overwrite"}`
  - [ ] `ImportStateIdFunc: importStateIDFunc(<name>ResourceName)`
- [ ] Helper function(s) returning HCL config strings

### 3. Example
**Path**: `examples/resources/grafana_apps_<group>_<kind>_<version>/resource.tf`

Content must include:
- [ ] A valid HCL resource block using the TF resource name
- [ ] `metadata { uid = "..." }` block
- [ ] `spec { ... }` block with all required fields populated
- [ ] Realistic example values (not just "foo"/"bar")
- [ ] Brief comments for non-obvious fields

---

## Files to MODIFY

### 4. Provider resource registration
**Path**: `pkg/provider/resources.go`

Change required:
- [ ] Add `appplatform.<Name>()` inside `AppPlatformResources()` function (around line 83–97)
- [ ] Keep alphabetical or logical ordering consistent with existing entries

### 5. Example test gating (if needed)
**Path**: `internal/resources/examples_test.go`

Only modify if:
- The resource belongs to a new category not already in the file, OR
- The resource requires special version gating different from the category default

Change required:
- [ ] Add a `case` inside the appropriate category's `testCheck` function:
  ```go
  case strings.Contains(filename, "grafana_apps_<group>_<kind>"):
      testutils.Check<OSS|Enterprise>TestsEnabled(t, "<version>")
  ```

---

## Files GENERATED (do not manually edit)

### 6. Docs
**Path**: `docs/resources/apps_<group>_<kind>_<version>.md`

Generated by: `make docs` (or `go generate ./...`)

- [ ] Run `make docs` after all source files are complete
- [ ] Verify the file was created at the expected path
- [ ] Check that the description and schema attributes look correct

---

## Resource Naming Formula

```
grafana_apps_{first-segment-of-group}_{lowercase-kind}_{version}
```

**Implementation** in `resource.go:formatResourceType()`:
```go
g := strings.Split(kind.Group(), ".")[0]
return fmt.Sprintf("grafana_apps_%s_%s_%s", g, strings.ToLower(kind.Kind()), kind.Version())
```

**Examples:**
| Group | Kind | Version | TF Resource Name |
|-------|------|---------|-----------------|
| `alerting.grafana.app` | `AlertEnrichment` | `v1beta1` | `grafana_apps_alerting_alertenrichment_v1beta1` |
| `notifications.alerting.grafana.app` | `InhibitionRule` | `v0alpha1` | `grafana_apps_notifications_inhibitionrule_v0alpha1` |
| `playlist.grafana.app` | `Playlist` | `v0alpha1` | `grafana_apps_playlist_playlist_v0alpha1` |
| `secret.grafana.app` | `SecureValue` | `v0alpha1` | `grafana_apps_secret_securevalue_v0alpha1` |

Note: Only the **first** dot-segment of the group is used. `notifications.alerting.grafana.app` → `notifications`.
